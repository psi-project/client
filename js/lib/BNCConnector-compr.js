(function(){window.DISABLE_MONITOR=false;var af=function(ak){this.data=[];if(ak.length>D){throw"Name cannot be longer than "+D+" characters"}var aj=ak.length;for(var al=0;al<D-aj;al++){ak=ak+"_"}for(var al=0;al<af.PEERS.length;al++){if(af.PEERS[al]==ak){throw"This IP is in use locally!"}}this.name=ak;this.init();this.BUSY=false;this.current=false;this.message="";p.start();p.register(this.name);af.PEERS.push(this.name)};af.PEERS=[];af.prototype.getAllPeers=function(){var am=O();var ak=[];var aj=am[2].length;for(var al=0;al<aj;al++){ak[al]=am[2][al][0]}return ak};af.prototype.init=function(){if(getPacket()[R]==this.name){a(k)}this.process()};af.prototype.checkPacket=function(){if(this.destroyed){return null}if(this.check_locked){return null}this.check_locked=true;var al=this;var ak=getPacket();if(ak[Y]==this.name){if(ak[I]){try{a(k);this.recived_timestamp=false;if(this.message===null){this.onerror("null message",this.last_packet)}else{this.listen(ak[R],this.message)}}catch(aj){}this.message=""}else{if(!ak[d]){if(ak[s].charAt(0)=="1"){this.message=""}this.message+=ak[s].substring(1,ak[s].length);a(ak[Y]+"110"+ak[R]+ak[s]);this.recived_timestamp=new Date().valueOf();this.check_locked=false;e(function(){al.checkPacket()},x)}}}else{if(ak[Y]){}}this.check_locked=false;return[ak,false]};af.prototype.listen=function(aj,ak){};af.prototype.sendData=function(ak,aj){if(this.destroyed){return}this.pushPackets(aj,ak)};af.prototype.TRANSMIT_CHUNK=0;af.prototype.transmit=function(al){if(window.interrupt||(this.current_sent_not&&((this.current_sent_not+P)<new Date().valueOf()))){try{if(window.interrupt){this.onerror("interrupted",this.last_packet)}else{this.onerror("timedout: either peer does not exist or cookie try lower packet size on cookie setting.",this.last_packet)}}catch(aj){}this.current=false;this.not_finished=false;this.current_sent_not=false;window.interrupt=false}var ak=this.current;var am=this;if(al[l]&&(al[R]!=this.name)){return false}if(ak){if(al[d]&&al[R]==this.name){if(!ak[0][0]){this.onsent(this.last_packet);this.last_packet=[];a(ak[1]+"101"+this.name+al[s]);this.current=false;e(function(){am.not_finished=false},f*(0.5+(Math.random()*0.5)))}else{a(ak[1]+"100"+this.name+ak[0][0]);ak[0].splice(0,1)}this.current_sent_not=false}else{if(!this.current_sent_not){this.current_sent_not=new Date().valueOf();a(ak[1]+"100"+this.name+ak[0][0]);ak[0].splice(0,1)}}}else{return false}return true};af.prototype.onerror=function(ak,aj){};af.prototype.onsent=function(aj){};af.prototype.TMP_STACK=[];af.prototype.process=function(){if(this.destroyed){return}var al=this;var ak=this.checkPacket()[0];if(!this.not_finished){if((!this.current)&&(this.data[0])){this.not_finished=true;this.current=this.data[0];this.last_packet=[this.data[0][0]+"",this.data[0][1]+""];this.data.splice(0,1)}}var aj=this.transmit(ak);if(!aj){e(function(){al.process()},f)}else{e(function(){al.process()},x)}};af.prototype.pushPackets=function(aj,am){var ao=Z-1;var al=Math.floor(aj.length/ao)+1;var an=[];var ap=1;for(var ak=0;ak<al;ak++){an.push(ap+aj.substring(ak*ao,(ak+1)*ao));ap=0}this.data.push([an,am])};af.prototype.destroy=function(){p.unregister(this.name);for(var aj=0;aj<af.PEERS.length;aj++){if(af.PEERS[aj]==this.name){af.PEERS.splice(aj,1)}}this.destroyed=true};window.BNCConnector=af;var p=function(){return p};p.cleanDeadlocksOnly=false;p.singleton=false;var V=false;if(navigator.userAgent.toLowerCase().lastIndexOf("opera")!=-1){V=true}p.start=function(){if(window.DISABLE_MONITOR){return false}if(!h(E)||h(E)==""||h(E)==null){ac("",true)}if(p.singleton){return p.singleton}p.singleton=p;r(O(),1);this.stopped=false;var ak=new Date().valueOf();var al=new Date().valueOf();var at=function(){if(p.stopped){p.singleton=false;return}var ax=O();if(p.isFreezed(ax)!==false){B(ax);ax=O();r(ax,0,p.localPeers,1)}};at();var av=110,aw=700;if(V||window.ONUNLOAD_NOT_SUPPORTED){av=30;aw=110}var au=function(){if(p.stopped){p.singleton=false;return}var ax=getPacket();var ay=ax[ag];if(ax[Y]!="00"&&(isNaN(ay)||(ay+P*3)<new Date().valueOf())){a(k);j("Deadlock detected. Resetting.")}if(!p.cleanDeadlocksOnly){var az=new Date().valueOf();if(az-ak>av){p.announceAll();ak=new Date().valueOf()}if(az-al>aw){at();al=new Date().valueOf()}}e(au,20)};au();var ar=function(){for(var ax=0;ax<p.localPeers.length;ax++){B(O(),p.localPeers[ax])}};var am=window.onclose;var aq=window.onbeforeunload;var aj=function(ay){ar();try{am(ay)}catch(ax){}};var ao=function(ay){ar();try{aq(ay)}catch(ax){}};if(!window.ONUNLOAD_NOT_SUPPORTED){var ap=document.createElement("iframe");ap.src="about:blank";top.cleanUpBNCConnector=function(){ar()};try{document.getElementsByTagName("body")[0].parentNode.appendChild(ap);ap.contentWindow.document.write("<script> window.onclose=function(){top.cleanUpBNCConnector();}; window.onunload=function(){top.cleanUpBNCConnector();}; window.onbeforeunload=function(){top.cleanUpBNCConnector();};<\/script>");ap.style.display="none";ap.src="about:blank";ap.contentWindow.onunload=top.cleanUpBNCConnector;ap.contentWindow.onbeforeunload=top.cleanUpBNCConnector;ap.contentWindow.onclose=top.cleanUpBNCConnector}catch(an){}window.onunload=aj;window.onbeforeunload=ao}};p.announceAll=function(){var am=O();var ak="";for(var al=0;al<p.localPeers.length;al++){var aj=p.localPeers[al];y(am,aj,1)}ak=K(am);ac(ak)};var S=400;if(V||window.ONUNLOAD_NOT_SUPPORTED){S=120}p.isFreezed=function(aj){if((isNaN(aj[0]*1))||(aj[0]*1>0&&(aj[0]*1+S)<new Date().valueOf())){return true}return false};p.stop=function(){this.stopped=true};p.getAllPeers=function(){var ao=O();var al=[];var aj=ao[2].length;for(var am=0;am<aj;am++){al[am]=ao[2][am][0]}for(var ak=0;ak<p.localPeers.length;ak++){var an=false;for(var am=0;am<aj;am++){if(al[am]==p.localPeers[ak]){an=true;break}}if(!an){al.push(p.localPeers[ak])}}return al};p.register=function(aj){p.localPeers.push(aj);p.announceAll()};p.unregister=function(aj){for(var ak=0;ak<p.localPeers.length;ak++){if(p.localPeers[ak]==aj){p.localPeers.splice(ak,1)}}B(O(),aj)};p.localPeers=[];window.BNCConnectorMonitor=p;var G=false;if(navigator.appName=="Microsoft Internet Explorer"){G=true}if(G){Array.prototype.push=function(aj){return this[this.length]=aj}}var V=false;if(navigator.userAgent.toLowerCase().lastIndexOf("opera")!=-1){V=true}if(!window.console){window.console={};console.log=function(){}}var M=function(aj){return encodeURIComponent(aj)};var aa=function(aj){return decodeURIComponent(aj)};var z=0;var W="; expires="+new Date(new Date().getTime()+86400000*1000).toGMTString();var ah=function(){return";"};var ab="TCP";var q="";var E="MCP";function j(aj,ak){if(window.console){console.log(aj,ak)}}function h(ak){var am=document.cookie;var al=am.indexOf(ak+"=");if(al!=-1){al+=ak.length+1;var aj=am.indexOf(";",al);if(aj==-1){aj=am.length}return aa(am.substring(al,aj))}else{return""}}function o(aj,ak){document.cookie=aj+"="+M(ak)}var u=0;function a(aj){u=new Date().valueOf();o(ab,u+aj)}var Y=0,l=1,d=2,I=3,R=4,s=5,ag=6;window.getPacket=function(){var ak=h(ab);var aj=[];aj[Y]=ak.substring(13,U);aj[l]=ak.charAt(U)*1;aj[d]=ak.charAt(n)*1;aj[I]=ak.charAt(t)*1;aj[R]=ak.substring(ad,Q);aj[s]=ak.substring(N,ak.length);aj[ag]=ak.substring(0,13)*1;return aj};var x=0;var f=5;var P=G?100:55;var Z=window.PACKET_SIZE||(2000+4+11);var ae=window.RECEIVERS_LIMIT||128;var D=window.IP_LIMIT||2;var U=D+13;var n=U+1;var t=n+1;var ad=t+1;var Q=ad+D;var N=Q;var k="00000000000000000000";var m="##000##0000000000000";var L=ae*(D+1);if(!h(ab)||h(ab)==null||h(ab)==""){a(k)}var X=3;function O(){var am=h(E);var ao=am.substring(13);var al=am.substring(0,13);var aj=[];if(ao!==null){var an=ao.length/X;for(var ak=0;ak<an;ak++){aj[ak]=[ao.substring(ak*3,ak*3+2),ao.charAt(ak*3+2)]}}return[al,ao,aj]}function ac(al,aj){var ak=new Date().valueOf();if(!aj){ak=O()[0]}o(E,ak+al)}function J(an,ak){if(!an||an==""){return true}var aj=an[2].length;var am=false;var al=0;for(;al<aj;al++){var ao=an[2][al][0];if(ao==ak){am=true;break}}if(am){return true}else{return false}}var v={};var c=window.ERROR_TIMEOUT_MONITOR_MAX_AMOUNT||2;var H=window.DELAY_ALLOWED||800;if(V||window.ONUNLOAD_NOT_SUPPORTED){c=1;H=100}function B(ao,an){var al="";var ak=ao[2].length;for(var am=0;am<ak;am++){var ap=ao[2][am][1];var aj=ao[2][am][0];if(ap*1!==0||aj==an){if(aj!=an){v[aj]=[new Date().valueOf(),0];al+=aj+ap}else{v[aj]=undefined}}else{if(!an){if(v[aj]!==undefined){if((v[aj][0]+H)<new Date().valueOf()){if(v[aj][1]>c){v[aj]=undefined}else{if(c){v[aj]=[new Date().valueOf(),v[aj][1]+1];v[aj][1]++;al+=aj+ap}}}else{al+=aj+ap}}else{if(v[aj]===undefined){v[aj]=[new Date().valueOf(),1]}al+=aj+ap}}}}ac(al,true);return ao}function r(ak,ao,aq,al){var ar="";var ap=ak[2].length;for(var an=0;an<ap;an++){ak[2][an][1]=ao}var at=0;if(aq){for(var am=at;am<aq.length;am++){var aj=false;ap=ak[2].length;for(var an=0;an<ap;an++){if(aq[am]==ak[2][an][0]){ak[2][an][1]=al;at++;aj=true;break}}if(!aj){ak[2].push([aq[at]+"",1]);at++}}}ap=ak[2].length;for(var an=0;an<ap;an++){ar+=ak[2][an][0]+ak[2][an][1]}ac(ar);return ar}function F(ao,am,al){var ak="";var aj=ao[2].length;for(var an=0;an<aj;an++){if(ao[2][an][0]==am){ao[2][an][1]=al}ak+=ao[2][an][0]+ao[2][an][1]}ac(ak);return ak}function y(ao,al,ak){var aj=ao[2].length;var an=false;for(var am=0;am<aj;am++){if(ao[2][am][0]==al){ao[2][am][1]=ak;an=true}}if(!an){ao[2][ao[2].length]=[];ao[2][ao[2].length-1][0]=al;ao[2][ao[2].length-1][1]=ak}return ao}function K(am){var ak="";var aj=am[2].length;for(var al=0;al<aj;al++){ak+=am[2][al][0]+am[2][al][1]}return ak}var b=function(aj){this.obj=aj};b.prototype.del=function(){if(this.prev){this.prev.next=this.next}if(this.next){this.next.prev=this.prev}delete this.obj;this.obj=undefined};var A=function(){this.length=0};A.prototype.push=function(ak){var aj=new b(ak);if(this.last){this.last.next=aj;this.last.next.prev=this.last}else{this.first=aj}this.last=aj;this.length++};A.prototype.rm=function(aj){if(aj===this.last){this.last=this.last.prev}if(aj===this.first){this.first=this.first.next}aj.del();this.length--;if(this.length==0){this.last=this.first=undefined}};window.MAX_TIMEOUT_GRAN=1;window.FORCE_NOT_USING_NORMAL_TIMEOUT=(true&&!G);var T=new A();var g=MAX_TIMEOUT_GRAN;var i=false;var w=true;window.BNCReady=function(){};var C=function(){if(i){return}i=true;var aj=new Date().valueOf();var ao=T.length;if(w){w=false;try{window.BNCReady()}catch(al){}}if(ao>0){var an=T.first;var am;for(var ak=0;ak<ao;ak++){am=an.next;if(an.obj[0]&&an.obj[1]<aj){try{an.obj[0]();T.rm(an)}catch(al){}}an=am}}i=false};var ai=function(){for(var aj=0;aj<1000/g;aj++){setTimeout(C,1000+g*aj)}setTimeout(ai,1000)};if(FORCE_NOT_USING_NORMAL_TIMEOUT){ai()}function e(aj,ak){if(FORCE_NOT_USING_NORMAL_TIMEOUT){return T.push([aj,(new Date().valueOf())+ak])}else{if(w){w=false;try{window.BNCReady()}catch(al){}}return setTimeout(aj,ak)}}})();